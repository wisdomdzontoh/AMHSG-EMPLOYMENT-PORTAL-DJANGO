{% extends 'authentication/dash-base.html' %}{% load static %}{% block content%}

<div class="max-w-5xl mx-auto bg-white p-8 rounded-lg shadow-lg flex gap-8">
  <!-- Sidebar Menu -->
  <aside class="w-1/4">
    <ul class="space-y-4">
      <li
        id="step-1"
        class="flex items-center cursor-pointer p-3 rounded-lg bg-indigo-100 text-indigo-700"
        onclick="showSection(1)"
        role="button"
      >
        <span
          class="mr-3 bg-indigo-500 text-white rounded-full h-8 w-8 flex items-center justify-center"
          >1</span
        >
        <div>
          <p class="font-semibold">Personal Information</p>
          <p class="text-sm text-indigo-500">Add / Edit Personal Info</p>
        </div>
      </li>
      <li
        id="step-2"
        class="flex items-center cursor-pointer p-3 rounded-lg hover:bg-gray-200"
        onclick="showSection(2)"
        role="button"
      >
        <span
          class="mr-3 bg-gray-300 text-gray-700 rounded-full h-8 w-8 flex items-center justify-center"
          >2</span
        >
        <div>
          <p class="font-semibold">Educational Background</p>
          <p class="text-sm text-gray-500">Add education</p>
        </div>
      </li>
      <li
        id="step-3"
        class="flex items-center cursor-pointer p-3 rounded-lg hover:bg-gray-200"
        onclick="showSection(3)"
        role="button"
      >
        <span
          class="mr-3 bg-gray-300 text-gray-700 rounded-full h-8 w-8 flex items-center justify-center"
          >3</span
        >
        <div>
          <p class="font-semibold">Evidence of Registration</p>
          <p class="text-sm text-gray-500">with relevant regulatory body</p>
        </div>
      </li>
      <li
        id="step-4"
        class="flex items-center cursor-pointer p-3 rounded-lg hover:bg-gray-200"
        onclick="showSection(4)"
        role="button"
      >
        <span
          class="mr-3 bg-gray-300 text-gray-700 rounded-full h-8 w-8 flex items-center justify-center"
          >4</span
        >
        <div>
          <p class="font-semibold">Medical History</p>
          <p class="text-sm text-gray-500">add medical reports here</p>
        </div>
      </li>
      <li
        id="step-5"
        class="flex items-center cursor-pointer p-3 rounded-lg hover:bg-gray-200"
        onclick="showSection(5)"
        role="button"
      >
        <span
          class="mr-3 bg-gray-300 text-gray-700 rounded-full h-8 w-8 flex items-center justify-center"
          >5</span
        >
        <div>
          <p class="font-semibold">Posting Preference</p>
          <p class="text-sm text-gray-500">select your choice of work</p>
        </div>
      </li>
      <li
        id="step-6"
        class="flex items-center cursor-pointer p-3 rounded-lg hover:bg-gray-200"
        onclick="showSection(6)"
        role="button"
      >
        <span
          class="mr-3 bg-gray-300 text-gray-700 rounded-full h-8 w-8 flex items-center justify-center"
          >6</span
        >
        <div>
          <p class="font-semibold">Medical Certificate</p>
          <p class="text-sm text-gray-500">add your medical certifications</p>
        </div>
      </li>
      <li
        id="step-7"
        class="flex items-center cursor-pointer p-3 rounded-lg hover:bg-gray-200"
        onclick="showSection(7)"
        role="button"
      >
        <span
          class="mr-3 bg-gray-300 text-gray-700 rounded-full h-8 w-8 flex items-center justify-center"
          >7</span
        >
        <div>
          <p class="font-semibold">Addendum</p>
          <p class="text-sm text-gray-500">Brief summary</p>
        </div>
      </li>
    </ul>
  </aside>
  <!-- Main Form Content -->
  <div class="w-3/4">
    
    <form
      id="applicationForm"
      method="POST"
      enctype="multipart/form-data"
      action="{% url 'application_form' %}"
    >
      {% csrf_token %}
      <div id="form-1-messages" class="my-4"></div>
      <input type="hidden" name="section" id="sectionInput" value="1" />

      <!-- Section 1: Personal Information -->
      <div
        id="section-1"
        class="form-section bg-white p-6 shadow-lg rounded-lg mb-8"
      >
        <h2 class="text-2xl font-bold text-blue-950 mb-6">
          Personal Information
        </h2>

        <!-- Personal Information Fields -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Field rendering with .as_p replaced by custom divs for better control -->
          <div class="flex flex-col">
            <label for="id_title" class="font-semibold text-gray-700 mb-1"
              >Job Title</label
            >
            {{ personal_info_form.job_title }}
          </div>

          <div class="flex flex-col">
            <label for="id_title" class="font-semibold text-gray-700 mb-1"
              >Title</label
            >
            {{ personal_info_form.title }}
          </div>

          <div class="flex flex-col">
            <label for="id_first_name" class="font-semibold text-gray-700 mb-1"
              >First Name</label
            >
            {{ personal_info_form.first_name }}
          </div>

          <div class="flex flex-col">
            <label for="id_surname" class="font-semibold text-gray-700 mb-1"
              >Surname</label
            >
            {{ personal_info_form.surname }}
          </div>

          <div class="flex flex-col">
            <label for="id_other_names" class="font-semibold text-gray-700 mb-1"
              >Other Names</label
            >
            {{ personal_info_form.other_names }}
          </div>

          <div class="flex flex-col">
            <label for="id_email" class="font-semibold text-gray-700 mb-1"
              >Email</label
            >
            {{ personal_info_form.email }}
          </div>

          <div class="flex flex-col">
            <label for="id_telephone" class="font-semibold text-gray-700 mb-1"
              >Telephone</label
            >
            {{ personal_info_form.telephone }}
          </div>

          <div class="flex flex-col">
            <label for="id_dob" class="font-semibold text-gray-700 mb-1"
              >Date of Birth</label
            >
            {{ personal_info_form.dob }}
          </div>

          <div class="flex flex-col">
            <label for="id_birthplace" class="font-semibold text-gray-700 mb-1"
              >Birthplace</label
            >
            {{ personal_info_form.birthplace }}
          </div>

          <div class="flex flex-col">
            <label for="marital_status" class="font-semibold text-gray-700 mb-1"
              >Marital Status</label
            >
            {{ personal_info_form.marital_status }}
          </div>

          <div class="flex flex-col">
            <label for="gender" class="font-semibold text-gray-700 mb-1"
              >Gender</label
            >
            {{ personal_info_form.gender }}
          </div>

          <div class="flex flex-col">
            <label for="fathers_name" class="font-semibold text-gray-700 mb-1"
              >Fathers Name</label
            >
            {{ personal_info_form.fathers_name }}
          </div>

          <div class="flex flex-col">
            <label
              for="fathers_occupation"
              class="font-semibold text-gray-700 mb-1"
              >Fathers Occupation</label
            >
            {{ personal_info_form.fathers_occupation }}
          </div>

          <div class="flex flex-col">
            <label for="mothers_name" class="font-semibold text-gray-700 mb-1"
              >Mothers Name</label
            >
            {{ personal_info_form.mothers_name }}
          </div>

          <div class="flex flex-col">
            <label
              for="mothers_occupation"
              class="font-semibold text-gray-700 mb-1"
              >Mothers Occupation</label
            >
            {{ personal_info_form.mothers_occupation }}
          </div>

          <div class="flex flex-col">
            <label for="next_of_kin" class="font-semibold text-gray-700 mb-1"
              >Next of Kin</label
            >
            {{ personal_info_form.next_of_kin }}
          </div>

          <div class="flex flex-col">
            <label
              for="next_of_kin_occupation"
              class="font-semibold text-gray-700 mb-1"
              >Next of Kin Occupation</label
            >
            {{ personal_info_form.next_of_kin_occupation }}
          </div>

          <div class="flex flex-col">
            <label for="contact_person" class="font-semibold text-gray-700 mb-1"
              >Name of contact person</label
            >
            {{ personal_info_form.contact_person }}
          </div>

          <div class="flex flex-col">
            <label for="relation" class="font-semibold text-gray-700 mb-1"
              >Relation</label
            >
            {{ personal_info_form.relation }}
          </div>

          <div class="flex flex-col">
            <label
              for="contact_address"
              class="font-semibold text-gray-700 mb-1"
              >Contact Address</label
            >
            {{ personal_info_form.contact_address }}
          </div>

          <div class="flex flex-col">
            <label
              for="passport_picture"
              class="font-semibold text-gray-700 mb-1"
            >
              Passport Picture
            </label>

            <!-- Custom Upload Button -->
            <input
              type="file"
              name="passport_picture"
              id="passport_picture"
              class="hidden"
            />
            <label
              for="passport_picture"
              class="bg-indigo-600 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-indigo-700"
            >
              Upload Passport Picture
            </label>

            <!-- Preview Image Placeholder -->
            <img
              id="image_preview"
              class="mt-4 w-32 h-32 object-cover rounded-full border border-gray-300"
              src="#"
              alt="Image Preview"
              style="display: none"
            />

            <!-- Help text or validation messages -->
            <small class="text-gray-500 mt-1"
              >Accepted formats: JPG, PNG. Max size: 2MB</small
            >
          </div>
        </div>

        <!-- Button Group -->
        <div class="flex justify-between mt-8">
          <button
            type="button"
            class="bg-gray-400 text-white px-6 py-2 rounded-lg cursor-not-allowed opacity-50"
            id="prevButton-1"
            disabled
          >
            Previous
          </button>

          <button
            type="button"
            class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700"
            onclick="showNextSection(1)"
          >
            Next
          </button>
        </div>
      </div>

      <!-- Section 2: Educational Background -->
      <div id="form-2-messages" class="my-4"></div>
      <div id="section-2" class="form-section hidden">
        
        <h2 class="text-xl font-bold mb-4">Educational Background</h2>

        <!-- Educational Fields -->
        <div class="grid grid-cols-1 gap-8">
          <!-- JHS Section -->
          <div class="border p-4 rounded-lg bg-gray-100 mb-6">
            <h3 class="text-lg font-semibold mb-3">JHS</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="flex flex-col">
                <label
                  for="id_JHS_school"
                  class="font-semibold text-gray-700 mb-1"
                  >School Name</label
                >
                {{ education_form.JHS_school }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_JHS_level"
                  class="font-semibold text-gray-700 mb-1"
                  >Degree</label
                >
                {{ education_form.JHS_level }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_JHS_field_of_study"
                  class="font-semibold text-gray-700 mb-1"
                  >Field of Study</label
                >
                {{ education_form.JHS_field_of_study }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_JHS_date_started"
                  class="font-semibold text-gray-700 mb-1"
                  >Start Date</label
                >
                {{ education_form.JHS_date_started }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_JHS_date_completed"
                  class="font-semibold text-gray-700 mb-1"
                  >End Date</label
                >
                {{ education_form.JHS_date_completed }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_JHS_certificates"
                  class="font-semibold text-gray-700 mb-1"
                  >Upload Certificates</label
                >
                <input
                  type="file"
                  id="id_JHS_certificates"
                  name="JHS_certificates"
                  class="border rounded p-2"
                  accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                  onchange="previewFile('JHS')"
                />
                <div id="file-preview-JHS" class="mt-4"></div>
              </div>
            </div>
          </div>

          <!-- SHS Section -->
          <div class="border p-4 rounded-lg bg-gray-100 mb-6">
            <h3 class="text-lg font-semibold mb-3">SHS</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="flex flex-col">
                <label
                  for="id_SHS_school"
                  class="font-semibold text-gray-700 mb-1"
                  >School Name</label
                >
                {{ education_form.SHS_school }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_SHS_level"
                  class="font-semibold text-gray-700 mb-1"
                  >Degree</label
                >
                {{ education_form.SHS_level }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_SHS_field_of_study"
                  class="font-semibold text-gray-700 mb-1"
                  >Field of Study</label
                >
                {{ education_form.SHS_field_of_study }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_SHS_date_started"
                  class="font-semibold text-gray-700 mb-1"
                  >Start Date</label
                >
                {{ education_form.SHS_date_started }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_SHS_date_completed"
                  class="font-semibold text-gray-700 mb-1"
                  >End Date</label
                >
                {{ education_form.SHS_date_completed }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_SHS_certificates"
                  class="font-semibold text-gray-700 mb-1"
                  >Upload Certificates</label
                >
                <input
                  type="file"
                  id="id_SHS_certificates"
                  name="SHS_certificates"
                  class="border rounded p-2"
                  accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                  onchange="previewFile('SHS')"
                />
                <div id="file-preview-SHS" class="mt-4"></div>
              </div>
            </div>
          </div>

          <!-- Tertiary Section -->
          <div class="border p-4 rounded-lg bg-gray-100 mb-6">
            <h3 class="text-lg font-semibold mb-3">Tertiary</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="flex flex-col">
                <label
                  for="id_TERTIARY_school"
                  class="font-semibold text-gray-700 mb-1"
                  >School Name</label
                >
                {{ education_form.TERTIARY_school }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_TERTIARY_level"
                  class="font-semibold text-gray-700 mb-1"
                  >Degree</label
                >
                {{ education_form.TERTIARY_level }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_TERTIARY_field_of_study"
                  class="font-semibold text-gray-700 mb-1"
                  >Field of Study</label
                >
                {{ education_form.TERTIARY_field_of_study }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_TERTIARY_date_started"
                  class="font-semibold text-gray-700 mb-1"
                  >Start Date</label
                >
                {{ education_form.TERTIARY_date_started }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_TERTIARY_date_completed"
                  class="font-semibold text-gray-700 mb-1"
                  >End Date</label
                >
                {{ education_form.TERTIARY_date_completed }}
              </div>

              <div class="flex flex-col">
                <label
                  for="id_TERTIARY_certificates"
                  class="font-semibold text-gray-700 mb-1"
                  >Upload Certificates</label
                >
                <input
                  type="file"
                  id="id_TERTIARY_certificates"
                  name="TERTIARY_certificates"
                  class="border rounded p-2"
                  accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                  onchange="previewFile('TERTIARY')"
                />
                <div id="file-preview-TERTIARY" class="mt-4"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Button Group -->
        <div class="flex justify-between mt-8">
          <button
            type="button"
            class="bg-gray-500 text-white py-2 px-4 rounded"
            onclick="showPrevSection(2)"
          >
            Previous
          </button>
          <button
            type="button"
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
            onclick="showNextSection(2)"
          >
            Next
          </button>
        </div>
      </div>

      <!-- Section 3: Professional Registration -->
      <div id="form-3-messages" class="my-4"></div>
      <div id="section-3" class="form-section hidden">
        <h2 class="text-xl font-bold mb-4">Professional Registration</h2>

        <!-- Professional Registration Fields -->
        <div class="grid grid-cols-1 gap-6">
          <!-- Regulatory Body -->
          <div class="flex flex-col">
            <label
              for="regulatory_body"
              class="font-semibold text-gray-700 mb-1"
              >Regulatory Body</label
            >
            {{ professional_form.regulatory_body }}
          </div>

          <!-- Registration Pin -->
          <div class="flex flex-col">
            <label
              for="registration_pin"
              class="font-semibold text-gray-700 mb-1"
              >Registration Pin</label
            >
            {{ professional_form.registration_pin }}
          </div>

          <!-- Date Received -->
          <div class="flex flex-col">
            <label for="date_received" class="font-semibold text-gray-700 mb-1"
              >Date Reeived</label
            >
            {{ professional_form.date_received }}
          </div>

          <!-- License Certificate -->
          <div class="flex flex-col">
            <label
              for="id_license_cert"
              class="font-semibold text-gray-700 mb-1"
              >Upload License Certificate</label
            >
            <input
              type="file"
              id="id_license_cert"
              name="license_cert"
              class="border border-gray-300 rounded-lg px-3 py-2"
              onchange="previewFile(this)"
            />
            <div id="license_cert_preview" class="mt-2">
              <!-- Preview content will be inserted here -->
            </div>
          </div>
        </div>

        <!-- Button Group -->
        <div class="flex justify-between mt-8">
          <button
            type="button"
            class="bg-gray-500 text-white py-2 px-4 rounded"
            onclick="showPrevSection(3)"
          >
            Previous
          </button>
          <button
            type="button"
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
            onclick="showNextSection(3)"
          >
            Next
          </button>
        </div>
      </div>

      <!-- Section 4: Work Experience -->
      <div id="form-4-messages" class="my-4"></div>
      <div id="section-4" class="form-section hidden">
        <h2 class="text-xl font-bold mb-4">Medical History</h2>
        {{ medical_history_form.as_p }}
        <div class="flex justify-between">
          <button
            type="button"
            class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
            onclick="showPrevSection(4)"
          >
            Previous
          </button>
          <button
            type="button"
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
            onclick="showNextSection(4)"
          >
            Next
          </button>
        </div>
      </div>

      <!-- Section 5: Posting Preference -->
      <div id="form-5-messages" class="my-4"></div>
<div id="section-5" class="form-section hidden">
  <h2 class="text-xl font-bold mb-4">Posting Preference</h2>
  
  <form id="posting-preference-form">
      <div class="mb-4">
          <label for="first_choice_region" class="block text-sm font-medium text-gray-700">First Choice Region</label>
          <select id="first_choice_region" name="first_choice_region" class="block w-full mt-1 rounded-md border-gray-300 shadow-sm">
              <option value="">Select a region</option>
              {% for region in regions %}
                  <option value="{{ region.id }}">{{ region.region_name }}</option>
              {% endfor %}
          </select>
      </div>

      <div class="mb-4">
          <label for="first_choice_facility" class="block text-sm font-medium text-gray-700">First Choice Facility</label>
          <select id="first_choice_facility" name="first_choice_facility" class="block w-full mt-1 rounded-md border-gray-300 shadow-sm" disabled>
              <option value="">Select a facility</option>
          </select>
      </div>

      <div class="mb-4">
          <label for="second_choice_region" class="block text-sm font-medium text-gray-700">Second Choice Region</label>
          <select id="second_choice_region" name="second_choice_region" class="block w-full mt-1 rounded-md border-gray-300 shadow-sm">
              <option value="">Select a region</option>
              {% for region in regions %}
                  <option value="{{ region.id }}">{{ region.region_name }}</option>
              {% endfor %}
          </select>
      </div>

      <div class="mb-4">
          <label for="second_choice_facility" class="block text-sm font-medium text-gray-700">Second Choice Facility</label>
          <select id="second_choice_facility" name="second_choice_facility" class="block w-full mt-1 rounded-md border-gray-300 shadow-sm" disabled>
              <option value="">Select a facility</option>
          </select>
      </div>

      <div class="mb-4">
          <label for="third_choice_region" class="block text-sm font-medium text-gray-700">Third Choice Region</label>
          <select id="third_choice_region" name="third_choice_region" class="block w-full mt-1 rounded-md border-gray-300 shadow-sm">
              <option value="">Select a region</option>
              {% for region in regions %}
                  <option value="{{ region.id }}">{{ region.region_name }}</option>
              {% endfor %}
          </select>
      </div>

      <div class="mb-4">
          <label for="third_choice_facility" class="block text-sm font-medium text-gray-700">Third Choice Facility</label>
          <select id="third_choice_facility" name="third_choice_facility" class="block w-full mt-1 rounded-md border-gray-300 shadow-sm" disabled>
              <option value="">Select a facility</option>
          </select>
      </div>
  </form>

  <div class="flex justify-between">
      <button type="button" class="bg-gray-500 text-white py-2 px-4 rounded" onclick="showPrevSection(5)">Previous</button>
      <button type="button" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700" onclick="showNextSection(5)">Next</button>
  </div>
</div>



      <!-- Section 6: Medical Certificate Upload -->
      <div id="form-6-messages" class="my-4"></div>
      <div id="section-6" class="form-section hidden">
        <h2 class="text-xl font-bold mb-4">Medical Certificate</h2>

        <div class="flex flex-col mb-4">
          <label
            for="id_medical_certificate"
            class="font-semibold text-gray-700 mb-2"
            >Upload Medical Certificate</label
          >
          <input
            type="file"
            id="id_medical_certificate"
            name="medical_cert"
            class="border rounded p-2"
            accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
            onchange="previewCertificate()"
          />
          <div id="certificate-preview" class="mt-4"></div>
        </div>

        <!-- Button Group -->
        <div class="flex justify-between">
          <button
            type="button"
            class="bg-gray-500 text-white py-2 px-4 rounded"
            onclick="showPrevSection(6)"
          >
            Previous
          </button>
          <button
            type="button"
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
            onclick="showNextSection(6)"
          >
            Next
          </button>
        </div>
      </div>

      <!-- Section 7: Addendum -->
      <div id="form-7-messages" class="my-4"></div>
      <div id="section-7" class="form-section hidden">
        <h2 class="text-xl font-bold mb-4">Addendum</h2>

        <!-- Attachments Section -->
        <h3 class="text-lg font-bold mt-4">A. Attachments</h3>
        <ol class="list-decimal list-inside ml-6 text-gray-700">
          <li>
            Registered General Nurses, Registered Midwives and auxiliary nurses
            are required to attach photocopies of the NMC results slips and
            PIN/AIN.
          </li>
          <li>
            Other Diploma holders are required to attach photocopies of their
            school certificates/transcripts, evidence of completion of National
            Service, and evidence of registration with the appropriate
            regulatory body where applicable.
          </li>
          <li>
            Other certificate holders are to attach photocopies of their school
            certificates. In all cases, applicants must attach photocopies of
            their birth certificates.
          </li>
        </ol>

        <!-- Programs and Grades Section -->
        <h3 class="text-lg font-bold mt-4">
          B. Programmes and Other Corresponding Grades
        </h3>
        <div class="overflow-x-auto">
          <table
            class="min-w-full table-auto border-collapse border border-gray-300 text-left text-sm"
          >
            <thead class="bg-gray-200">
              <tr>
                <th class="border border-gray-300 px-4 py-2">S/No.</th>
                <th class="border border-gray-300 px-4 py-2">
                  Programme of Study
                </th>
                <th class="border border-gray-300 px-4 py-2">
                  Corresponding Grade
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="border border-gray-300 px-4 py-2">1</td>
                <td class="border border-gray-300 px-4 py-2">
                  Degree/Advanced Diploma in CM/COH
                </td>
                <td class="border border-gray-300 px-4 py-2">
                  Physician Assistant
                </td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">2</td>
                <td class="border border-gray-300 px-4 py-2">
                  Diploma in Community Medicine & Health
                </td>
                <td class="border border-gray-300 px-4 py-2">
                  Medical Assistant
                </td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">3</td>
                <td class="border border-gray-300 px-4 py-2">
                  Diploma General Nursing, Psychiatry & Midwifery
                </td>
                <td class="border border-gray-300 px-4 py-2">
                  Staff Nurse, Staff Midwife
                </td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">4</td>
                <td class="border border-gray-300 px-4 py-2">
                  Diploma in Community Health Nursing
                </td>
                <td class="border border-gray-300 px-4 py-2">
                  Staff Nurse (RCN)
                </td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">5</td>
                <td class="border border-gray-300 px-4 py-2">
                  Certificate in Community Health Nursing
                </td>
                <td class="border border-gray-300 px-4 py-2">
                  Community Health Nurse
                </td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">6</td>
                <td class="border border-gray-300 px-4 py-2">
                  Certificate Health Assistant Clinical
                </td>
                <td class="border border-gray-300 px-4 py-2">Enrolled Nurse</td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">7</td>
                <td class="border border-gray-300 px-4 py-2">
                  Diploma in Disease Control, Health Information, Medical
                  Laboratory etc.
                </td>
                <td class="border border-gray-300 px-4 py-2">
                  Technical Officer (Specialty)
                </td>
              </tr>
              <tr>
                <td class="border border-gray-300 px-4 py-2">8</td>
                <td class="border border-gray-300 px-4 py-2">Others</td>
                <td class="border border-gray-300 px-4 py-2">
                  Field Technicians/Technical Assistant (Specialty)
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Other Certificate Upload Field with Preview -->
<div class="flex flex-col mb-6">
  <label for="id_other_cert" class="font-semibold text-gray-700 mb-2">
    Upload Other Certificate (e.g. Transcript)
  </label>
  <input
    type="file"
    id="id_other_cert"
    name="other_cert"
    class="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500 transition duration-200"
    accept=".pdf, .jpg, .jpeg, .png, .doc, .docx"
    onchange="previewOtherFile(this)"
  />
  <!-- Preview Area for Selected File -->
  <div id="file-preview" class="mt-3 text-gray-600"></div>
</div>

<h2 class="text-2xl font-semibold mb-6">Declaration</h2>
<p class="text-sm text-gray-600 mb-4">Consent to details given</p>

<!-- Declaration Text -->
<div class="border-t border-gray-300 pt-4 mb-6 text-gray-700">
  <p>
    I confirm that the information I have provided in this form is
    accurate to the best of my knowledge and belief. If however, it is
    detected that I have made any false claims, I may be committing an
    offence under Part One of Act 857 (2013).
  </p>
</div>

<!-- Table Structure for Final Declaration Fields -->
<form id="final-declaration-form" method="POST">
    {% csrf_token %}
    <table class="min-w-full bg-white border border-gray-300 rounded-lg mb-6">
      <tbody>
        <tr class="border-b border-gray-300">
          <td class="py-4 px-6 font-semibold text-gray-700">Agreement</td>
          <td class="py-4 px-6">
            {{ declaration_form.agree }}
          </td>
        </tr>
        <tr class="border-b border-gray-300">
          <td class="py-4 px-6 font-semibold text-gray-700">Date</td>
          <td class="py-4 px-6">
            {{ declaration_form.date }}
          </td>
        </tr>
        <tr>
          <td class="py-4 px-6 font-semibold text-gray-700">Signature</td>
          <td class="py-4 px-6">
            {{ declaration_form.signature }}
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Button Group with Improved Styling -->
    <div class="flex justify-between">
      <button
        type="button"
        class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
        onclick="showSection(7)"
      >
        Previous
      </button>
      <button
        type="submit"
        class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"
      >
        Submit Application
      </button>
    </div>
</form>

</div>
</div>



<!-- Embed the facilities data into a JavaScript object -->
<script type="text/javascript">
  const facilitiesByRegion = {{ facilities_by_region|safe }};  // This passes the Python dictionary to JS
</script>


<!--other certificates javascript code-->
<script>
  // Function to preview selected file
  function previewOtherFile(input) {
    const file = input.files[0];
    const previewContainer = document.getElementById('file-preview');

    if (file) {
      const fileType = file.type;
      const fileName = file.name;

      // Check if the file is an image
      if (fileType.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function (e) {
          previewContainer.innerHTML = `<img src="${e.target.result}" alt="${fileName}" class="w-32 h-32 object-cover mt-3">`;
        };
        reader.readAsDataURL(file);
      } else {
        // Show file name and type for non-image files
        previewContainer.innerHTML = `<p class="text-gray-700 mt-3">File: ${fileName}</p>`;
      }
    } else {
      previewContainer.innerHTML = ''; // Clear the preview if no file is selected
    }
  }
</script>







<script>
  function showSection(sectionNumber) {
    const sections = document.querySelectorAll('[id^="section-"]');
    
    // Hide all sections
    sections.forEach((section) => section.classList.add("hidden"));
  
    // Show the selected section
    document.getElementById(`section-${sectionNumber}`).classList.remove("hidden");
  
    // Update step navigation visual indicators
    const steps = document.querySelectorAll('[id^="step-"]');
    steps.forEach((step) => {
      step.classList.remove("bg-indigo-100", "text-indigo-700");
      step.querySelector("span").classList.replace("bg-indigo-500", "bg-gray-300");
      step.querySelector("span").classList.replace("text-white", "text-gray-700");
    });
  
    // Highlight the current step
    const selectedStep = document.getElementById(`step-${sectionNumber}`);
    selectedStep.classList.add("bg-indigo-100", "text-indigo-700");
    selectedStep.querySelector("span").classList.replace("bg-gray-300", "bg-indigo-500");
    selectedStep.querySelector("span").classList.replace("text-gray-700", "text-white");
}


function showNextSection(current) {
  const form = document.getElementById("applicationForm");
  const formData = new FormData(form);

  // Get the message container for the current section
  const messagesContainer = document.getElementById(`form-${current}-messages`);

  // Update the section input to match the current section number
  const sectionInput = document.getElementById("sectionInput");
  sectionInput.value = current;

  // Add the CSRF token for Django form submission security
  const csrfToken = document.querySelector('[name="csrfmiddlewaretoken"]').value;
  formData.append("csrfmiddlewaretoken", csrfToken);

  // Fetch request to submit the form via AJAX
  fetch(form.action, {
      method: "POST",
      body: formData,
      headers: {
          "X-CSRFToken": csrfToken, // Important for Django CSRF protection
      },
  })
      .then((response) => response.json())
      .then((data) => {
          if (data.success) {
              // Display success message in the message container
              messagesContainer.innerHTML = `<p class="text-green-600">${data.message}</p>`;
              if (data.redirect_url) {
                  // Redirect to success page if provided
                  window.location.href = data.redirect_url;
              } else if (data.next_section === null) {
                  // If it's the final section, submit the form
                  form.submit(); // Submit the entire form
              } else {
                  // Move to the next section, including section 8
                  showSection(data.next_section);
              }
          } else {
              // Show any validation or form errors from the server response
              messagesContainer.innerHTML = `<p class="text-red-600">${data.message || 'Please correct the errors in the form.'}</p>`;
          }
      })
      .catch((error) => {
          // Handle any network or other errors
          console.error("Error:", error);
          messagesContainer.innerHTML = `<p class="text-red-600">An error occurred while submitting the form. Please try again.</p>`;
      });
}

  

  function showPrevSection(current) {
    // Navigate to the previous section
    if (current > 1) showSection(current - 1);
  }
  
  // Initialize by showing the first section on page load
  document.addEventListener("DOMContentLoaded", function () {
    showSection(1);  // Show the first section initially
  });
</script>


<script>
  // JavaScript to handle the image preview
  document
    .getElementById("passport_picture")
    .addEventListener("change", function (event) {
      const imagePreview = document.getElementById("image_preview");
      const file = event.target.files[0];

      // Ensure file is selected and is an image
      if (file && file.type.startsWith("image/")) {
        const reader = new FileReader();

        // Set the preview image source to the selected file
        reader.onload = function (e) {
          imagePreview.src = e.target.result;
          imagePreview.style.display = "block";
        };

        reader.readAsDataURL(file);
      } else {
        imagePreview.style.display = "none";
      }
    });
</script>

<!-- JavaScript for license cert File Preview -->
<script>
  function previewFile(input) {
    const previewContainer = document.getElementById("license_cert_preview");
    const file = input.files[0];
    previewContainer.innerHTML = ""; // Clear previous preview

    if (file) {
      const fileType = file.type;
      const fileUrl = URL.createObjectURL(file);

      if (fileType.startsWith("image/")) {
        const img = document.createElement("img");
        img.src = fileUrl;
        img.alt = "Preview";
        img.className = "w-full h-auto border border-gray-300 rounded-lg mt-2";
        previewContainer.appendChild(img);
      } else if (fileType === "application/pdf") {
        const pdfEmbed = document.createElement("embed");
        pdfEmbed.src = fileUrl;
        pdfEmbed.type = "application/pdf";
        pdfEmbed.className =
          "w-full h-60 border border-gray-300 rounded-lg mt-2";
        previewContainer.appendChild(pdfEmbed);
      } else {
        const text = document.createElement("p");
        text.textContent = "Preview not available for this file type.";
        text.className = "text-gray-500 mt-2";
        previewContainer.appendChild(text);
      }
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    flatpickr("#id_date_received", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_dob", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_JHS_date_started", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_JHS_date_completed", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_SHS_date_started", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_SHS_date_completed", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_TERTIARY_date_started", {
      dateFormat: "Y-m-d",
    });

    flatpickr("#id_TERTIARY_date_completed", {
      dateFormat: "Y-m-d",
    });
  });
</script>

<!--Medical Certificate upload-->
<script>
  function previewCertificate() {
    const fileInput = document.getElementById("id_medical_certificate");
    const previewDiv = document.getElementById("certificate-preview");

    const file = fileInput.files[0];
    previewDiv.innerHTML = ""; // Clear previous content

    if (file) {
      const fileName = file.name;
      const fileType = file.type;

      if (fileType.startsWith("image/")) {
        // If it's an image, show the image preview
        const img = document.createElement("img");
        img.src = URL.createObjectURL(file);
        img.classList.add("w-32", "h-32", "object-cover", "mt-4");
        previewDiv.appendChild(img);
      } else {
        // For non-image files, just show the file name
        const fileLabel = document.createElement("p");
        fileLabel.textContent = `Selected File: ${fileName}`;
        fileLabel.classList.add("text-gray-700", "mt-2");
        previewDiv.appendChild(fileLabel);
      }
    }
  }
</script>





<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Handle cascading dropdowns
    function handleRegionChange(regionSelectId, facilitySelectId) {
        const regionSelect = document.getElementById(regionSelectId);
        const facilitySelect = document.getElementById(facilitySelectId);
        
        regionSelect.addEventListener('change', function () {
            const selectedRegion = regionSelect.value;
            facilitySelect.innerHTML = '<option value="">Select a facility</option>'; // Reset options
            if (selectedRegion && facilitiesByRegion[selectedRegion]) {
                facilitiesByRegion[selectedRegion].forEach(function (facility) {
                    const option = document.createElement('option');
                    option.value = facility.id;
                    option.textContent = facility.facility_name;
                    facilitySelect.appendChild(option);
                });
                facilitySelect.disabled = false;
            } else {
                facilitySelect.disabled = true;
            }
        });
    }

    // Apply cascading logic to the first, second, and third choices
    handleRegionChange('first_choice_region', 'first_choice_facility');
    handleRegionChange('second_choice_region', 'second_choice_facility');
    handleRegionChange('third_choice_region', 'third_choice_facility');

    // Prevent duplicate region and facility selections
    const allRegionSelects = [
        document.getElementById('first_choice_region'),
        document.getElementById('second_choice_region'),
        document.getElementById('third_choice_region')
    ];
    const allFacilitySelects = [
        document.getElementById('first_choice_facility'),
        document.getElementById('second_choice_facility'),
        document.getElementById('third_choice_facility')
    ];

    function preventDuplicateSelections(selects) {
        selects.forEach(function (select, index) {
            select.addEventListener('change', function () {
                const selectedValues = selects.map(s => s.value);
                selects.forEach(function (s, idx) {
                    if (idx !== index) {
                        [...s.options].forEach(function (option) {
                            option.disabled = selectedValues.includes(option.value) && option.value !== "";
                        });
                    }
                });
            });
        });
    }

    preventDuplicateSelections(allRegionSelects);
    preventDuplicateSelections(allFacilitySelects);
});

  </script>

{% endblock %}
